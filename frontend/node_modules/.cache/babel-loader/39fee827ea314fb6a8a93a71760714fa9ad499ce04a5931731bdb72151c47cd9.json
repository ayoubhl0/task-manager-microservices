{"ast":null,"code":"// src/services/authService.js\nconst API_URL = 'http://localhost:3001';\n\n// Récupérer le token du localStorage\nconst getToken = () => {\n  return localStorage.getItem('token');\n};\n\n// Récupérer les infos utilisateur du localStorage\nconst getUserFromStorage = () => {\n  const userStr = localStorage.getItem('user');\n  return userStr ? JSON.parse(userStr) : null;\n};\nexport const authService = {\n  async register(userData) {\n    const response = await fetch(`${API_URL}/register`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(userData)\n    });\n    const data = await response.json();\n    if (response.ok && data.token) {\n      localStorage.setItem('token', data.token);\n      localStorage.setItem('user', JSON.stringify(data.user));\n    }\n    return data;\n  },\n  async login(credentials) {\n    const response = await fetch(`${API_URL}/login`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(credentials)\n    });\n    const data = await response.json();\n    if (response.ok && data.token) {\n      localStorage.setItem('token', data.token);\n      localStorage.setItem('user', JSON.stringify(data.user));\n    }\n    return data;\n  },\n  // Fonction qui manquait\n  getCurrentUser() {\n    return getUserFromStorage();\n  },\n  // Fonction pour vérifier si l'utilisateur est connecté\n  isAuthenticated() {\n    const token = getToken();\n    const user = getUserFromStorage();\n    return !!(token && user);\n  },\n  // Déconnexion\n  logout() {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n  },\n  // Vérifier le token côté serveur\n  async verifyToken() {\n    const token = getToken();\n    if (!token) return null;\n    try {\n      const response = await fetch(`${API_URL}/verify`, {\n        method: 'GET',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        return await response.json();\n      }\n      return null;\n    } catch (error) {\n      console.error('Token verification failed:', error);\n      return null;\n    }\n  }\n};","map":{"version":3,"names":["API_URL","getToken","localStorage","getItem","getUserFromStorage","userStr","JSON","parse","authService","register","userData","response","fetch","method","headers","body","stringify","data","json","ok","token","setItem","user","login","credentials","getCurrentUser","isAuthenticated","logout","removeItem","verifyToken","error","console"],"sources":["C:/Users/ayoub/Desktop/task-manager-microservices - Copie/frontend/src/services/authService.js"],"sourcesContent":["// src/services/authService.js\r\nconst API_URL = 'http://localhost:3001';\r\n\r\n// Récupérer le token du localStorage\r\nconst getToken = () => {\r\n  return localStorage.getItem('token');\r\n};\r\n\r\n// Récupérer les infos utilisateur du localStorage\r\nconst getUserFromStorage = () => {\r\n  const userStr = localStorage.getItem('user');\r\n  return userStr ? JSON.parse(userStr) : null;\r\n};\r\n\r\nexport const authService = {\r\n  async register(userData) {\r\n    const response = await fetch(`${API_URL}/register`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(userData),\r\n    });\r\n    const data = await response.json();\r\n    \r\n    if (response.ok && data.token) {\r\n      localStorage.setItem('token', data.token);\r\n      localStorage.setItem('user', JSON.stringify(data.user));\r\n    }\r\n    \r\n    return data;\r\n  },\r\n\r\n  async login(credentials) {\r\n    const response = await fetch(`${API_URL}/login`, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify(credentials),\r\n    });\r\n    const data = await response.json();\r\n    \r\n    if (response.ok && data.token) {\r\n      localStorage.setItem('token', data.token);\r\n      localStorage.setItem('user', JSON.stringify(data.user));\r\n    }\r\n    \r\n    return data;\r\n  },\r\n\r\n  // Fonction qui manquait\r\n  getCurrentUser() {\r\n    return getUserFromStorage();\r\n  },\r\n\r\n  // Fonction pour vérifier si l'utilisateur est connecté\r\n  isAuthenticated() {\r\n    const token = getToken();\r\n    const user = getUserFromStorage();\r\n    return !!(token && user);\r\n  },\r\n\r\n  // Déconnexion\r\n  logout() {\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('user');\r\n  },\r\n\r\n  // Vérifier le token côté serveur\r\n  async verifyToken() {\r\n    const token = getToken();\r\n    if (!token) return null;\r\n\r\n    try {\r\n      const response = await fetch(`${API_URL}/verify`, {\r\n        method: 'GET',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n        },\r\n      });\r\n      \r\n      if (response.ok) {\r\n        return await response.json();\r\n      }\r\n      return null;\r\n    } catch (error) {\r\n      console.error('Token verification failed:', error);\r\n      return null;\r\n    }\r\n  }\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}